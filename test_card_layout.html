<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Layout Test</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Our CSS -->
    <link rel="stylesheet" href="/static/css/upcoming.css">
    
    <style>
        body {
            padding: 2rem;
            background: var(--bg-primary);
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="mb-4">Enhanced Card Test</h1>
        
        <!-- Test card with enhanced layout -->
        <div class="row">
            <div class="col-lg-4 col-md-6 col-sm-12">
                <article class="card h-100 audiobook-card border-warning">
                    <!-- Card Header with Author and Actions -->
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h6 class="mb-0 text-primary">Patora Fuyuhara</h6>
                        <div class="btn-group d-flex gap-2 align-items-center">
                            <span class="badge bg-warning">This Month</span>
                            <button class="btn btn-sm btn-outline-success btn-ical" 
                                    data-asin="B0FD512T61"
                                    title="Download calendar event (.ics file)"
                                    aria-label="Download calendar event for In Another World with My Smartphone: Volume 7">
                                <i class="fas fa-calendar-plus"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Card Body -->
                    <div class="card-body">
                        <div class="row">
                            <div class="col-4">
                                <div class="book-cover mb-3">
                                    <img src="/static/images/og-image.png" 
                                         alt="Cover of In Another World with My Smartphone: Volume 7" 
                                         class="book-cover-img"
                                         onerror="this.src='/static/images/og-image.png';"
                                         loading="lazy">
                                </div>
                            </div>
                            <div class="col-8">
                                <h5 class="card-title">In Another World with My Smartphone: Volume 7</h5>
                                <p class="text-muted mb-2">
                                    <i class="fas fa-list me-1"></i>
                                    In Another World With My Smartphone Series #7
                                </p>
                                <p class="text-muted mb-2">
                                    <i class="fas fa-microphone me-1"></i>
                                    Gabriel Michael, Ashely Biski
                                </p>
                                <p class="text-muted mb-3">
                                    <i class="fas fa-building me-1"></i>
                                    Podium Audio
                                </p>
                            </div>
                        </div>
                        
                        <div class="book-description mb-3">
                            <p class="text-muted small">Sixteen-year-old Mochizuki Touya has it all. Grand Duke of an upstart nation, inventor of goods ranging from hula hoops to caramelized popcorn, admini...</p>
                        </div>
                        
                        <div class="release-info">
                            <div class="d-flex align-items-center mb-2">
                                <i class="fas fa-calendar-day text-primary me-2"></i>
                                <span class="fw-bold">Monday, July 21, 2025</span>
                            </div>
                            <div class="d-flex align-items-center">
                                <i class="fas fa-clock text-muted me-2"></i>
                                <span class="text-muted">16 days from now</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Card Footer -->
                    <div class="card-footer bg-transparent">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="metadata-info">
                                <span class="badge">
                                    <i class="fas fa-tag me-1"></i>ASIN: B0FD512T61
                                </span>
                            </div>
                            <a href="https://www.audible.com/pd/B0FD512T61" 
                               target="_blank" 
                               rel="noopener"
                               class="btn btn-sm btn-outline-primary">
                                <i class="fas fa-external-link-alt me-1"></i>View on Audible
                            </a>
                        </div>
                        <small class="text-muted d-block mt-1">
                            <i class="fas fa-sync me-1"></i>
                            Updated: 7/5/2025
                        </small>
                    </div>
                </article>
            </div>
        </div>
        
        <div class="mt-4">
            <button class="btn btn-primary" onclick="testIcalDownload()">Test iCal Download</button>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        function testIcalDownload() {
            // Simulate iCal download
            console.log('Testing iCal download for ASIN: B0FD512T61');
            
            // Create download URL
            const downloadUrl = `/api/ical/download/B0FD512T61`;
            
            // Create temporary link element
            const link = document.createElement('a');
            link.href = downloadUrl;
            link.download = `audiobook-B0FD512T61.ics`;
            link.style.display = 'none';
            
            // Add to DOM, click, and remove
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Test button click handler
        document.addEventListener('click', (e) => {
            if (e.target.closest('.btn-ical')) {
                e.preventDefault();
                const button = e.target.closest('.btn-ical');
                const asin = button.dataset.asin;
                if (asin) {
                    testIcalDownload();
                }
            }
        });
    </script>
</body>
</html>
